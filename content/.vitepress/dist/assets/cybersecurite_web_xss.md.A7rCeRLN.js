import{_ as i,c as l,j as a,a as r,G as s,an as n,B as o,o as u}from"./chunks/framework.ys1W0Hiz.js";const q=JSON.parse('{"title":"Failles XSS","description":"","frontmatter":{"sidebar":"auto"},"headers":[],"relativePath":"cybersecurite/web/xss.md","filePath":"cybersecurite/web/xss.md","lastUpdated":1729429463000}'),d={name:"cybersecurite/web/xss.md"};function c(p,e,m,f,v,h){const t=o("Badge");return u(),l("div",null,[e[0]||(e[0]=a("h1",{id:"failles-xss",tabindex:"-1"},[r("Failles XSS "),a("a",{class:"header-anchor",href:"#failles-xss","aria-label":'Permalink to "Failles XSS"'},"​")],-1)),s(t,{type:"tip",text:"Rédigé le 16/10/2024"}),s(t,{type:"warning",text:"En cours de rédaction"}),e[1]||(e[1]=n('<h2 id="les-differents-types-de-failles-xss" tabindex="-1">Les différents types de failles XSS <a class="header-anchor" href="#les-differents-types-de-failles-xss" aria-label="Permalink to &quot;Les différents types de failles XSS&quot;">​</a></h2><ul><li><em><strong>Stored</strong></em>: Stock un payload dans le serveur</li><li><em><strong>Reflected</strong></em>: Nécessite l&#39;interaction de l&#39;utilisateur</li><li><em><strong>DOM-based</strong></em>: S&#39;installe côté client</li><li><em><strong>Self-XSS</strong></em>: Affecte uniquement l&#39;attaquant</li><li><em><strong>Blind XSS</strong></em> : L&#39;attaquant n&#39;a pas la capacité de voir le résultat</li></ul><h3 id="xss-reflected" tabindex="-1">XSS Reflected <a class="header-anchor" href="#xss-reflected" aria-label="Permalink to &quot;XSS Reflected&quot;">​</a></h3><p>Le XSS réfléchi est un type d&#39;attaque qui nécessite une interaction de l&#39;utilisateur pour être exécuté. Par exemple, l&#39;attaquant injecte un code malveillant dans une requête HTTP, qui est ensuite renvoyé à l&#39;utilisateur dans la réponse du serveur. Par exemple, si un site web a une fonction de recherche qui affiche les termes recherchés sans les filtrer correctement, un attaquant pourrait injecter un script malveillant dans l&#39;URL de recherche. Lorsque l&#39;utilisateur clique sur ce lien malveillant, le script s&#39;exécute dans son navigateur. Pour exploiter cette vulnérabilité, l&#39;attaquant doit généralement inciter la victime à cliquer sur un lien spécialement conçu, souvent par le biais de techniques d&#39;ingénierie sociale comme le phishing.</p><h3 id="xss-stored" tabindex="-1">XSS Stored <a class="header-anchor" href="#xss-stored" aria-label="Permalink to &quot;XSS Stored&quot;">​</a></h3><p>Le XSS stocké est considéré comme plus dangereux car le code malveillant est stocké de manière permanente sur le serveur cible, généralement dans une base de données. Chaque fois qu&#39;un utilisateur visite la page affectée, le script malveillant est exécuté dans son navigateur. Un exemple courant est un forum en ligne où les utilisateurs peuvent poster des commentaires. Si le site ne filtre pas correctement les entrées des utilisateurs, un attaquant pourrait poster un commentaire contenant un script malveillant. Ce script serait alors exécuté dans le navigateur de chaque visiteur qui consulte la page du forum. Cette forme de XSS est particulièrement dangereuse car elle peut affecter un grand nombre d&#39;utilisateurs sans nécessiter d&#39;interaction supplémentaire de la part de l&#39;attaquant après l&#39;injection initiale.</p><h3 id="dom-based" tabindex="-1">DOM-based <a class="header-anchor" href="#dom-based" aria-label="Permalink to &quot;DOM-based&quot;">​</a></h3><p>Le Dom Access, ou XSS basé sur le DOM, est une vulnérabilité qui se produit entièrement du côté client. Contrairement aux autres types de XSS, le code malveillant n&#39;est pas envoyé au serveur, mais est exécuté directement dans le navigateur de l&#39;utilisateur en manipulant le Document Object Model (DOM) de la page. Cette attaque exploite les faiblesses dans les scripts côté client qui modifient dynamiquement le contenu de la page. Par exemple, si un script JavaScript prend des données d&#39;un paramètre d&#39;URL et les insère directement dans le DOM sans validation appropriée, un attaquant pourrait manipuler ce paramètre pour injecter du code malveillant. Les vulnérabilités Dom Access sont souvent plus difficiles à détecter car elles ne sont pas visibles dans le code source de la page, mais seulement dans le DOM modifié dynamiquement.</p><h3 id="self-xss" tabindex="-1">Self-XSS <a class="header-anchor" href="#self-xss" aria-label="Permalink to &quot;Self-XSS&quot;">​</a></h3><p>Le Self Access est une forme particulière de XSS où le code malveillant injecté n&#39;affecte que l&#39;utilisateur qui l&#39;a introduit. Cette situation se produit généralement dans des contextes où l&#39;utilisateur a un certain contrôle sur le contenu qu&#39;il voit, comme dans une page de profil personnalisable. Par exemple, si un utilisateur peut définir un nom d&#39;affichage personnalisé qui est ensuite affiché sur sa page de profil sans être correctement filtré, il pourrait théoriquement injecter un script qui s&#39;exécuterait chaque fois qu&#39;il visite sa propre page. Bien que le Self Access soit généralement considéré comme moins dangereux que d&#39;autres formes de XSS (puisqu&#39;il n&#39;affecte que l&#39;attaquant lui-même), il peut parfois être exploité pour contourner certaines mesures de sécurité ou pour démontrer l&#39;existence d&#39;une vulnérabilité plus large.</p><h3 id="blind-xss" tabindex="-1">Blind XSS <a class="header-anchor" href="#blind-xss" aria-label="Permalink to &quot;Blind XSS&quot;">​</a></h3><p>Le Blind Access, ou XSS aveugle, est une variante particulièrement insidieuse du XSS où l&#39;attaquant ne voit pas directement le résultat de son injection. Cette situation se produit souvent dans des contextes où l&#39;entrée de l&#39;utilisateur est traitée en arrière-plan ou affichée à d&#39;autres utilisateurs, comme dans un système de messagerie interne ou un panneau d&#39;administration. Par exemple, un attaquant pourrait injecter un script malveillant dans un formulaire de contact. Bien que l&#39;attaquant ne voie pas le résultat, le script pourrait s&#39;exécuter lorsqu&#39;un administrateur consulte les messages reçus. Les attaques de Blind Access sont particulièrement dangereuses car elles peuvent passer inaperçues pendant longtemps, permettant potentiellement à l&#39;attaquant de compromettre des comptes à privilèges élevés. Des outils comme XSS Hunter peuvent être utilisés pour détecter et exploiter ces vulnérabilités en envoyant des notifications à l&#39;attaquant lorsque le payload est exécuté.</p><h2 id="methodes-de-test" tabindex="-1">Méthodes de test <a class="header-anchor" href="#methodes-de-test" aria-label="Permalink to &quot;Méthodes de test&quot;">​</a></h2><p>Pour tester les vulnérabilités XSS, il est recommandé de suivre les étapes suivantes :</p><ul><li>Tester chaque paramètre et chaque valeur de paramètre.</li><li>Tester les en-têtes et les valeurs d&#39;en-tête.</li><li>Utiliser des outils comme Burp pour trouver des paramètres cachés.</li><li>Utiliser des payloads de test pour voir comment l&#39;application réagit.</li><li>Analyser les fichiers JavaScript pour trouver des vulnérabilités.</li></ul><h3 id="payloads-de-test" tabindex="-1">Payloads de test <a class="header-anchor" href="#payloads-de-test" aria-label="Permalink to &quot;Payloads de test&quot;">​</a></h3><p>Les payloads de test sont des codes malveillants qui sont utilisés pour tester les vulnérabilités XSS. Il est recommandé de commencer avec des payloads de test simples et de les rendre de plus en plus complexes pour voir comment l&#39;application réagit, exemple :</p><ul><li><code>&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;</code> : Ce payload de test simple injecte un script qui affiche une fenêtre d&#39;alerte avec le message &quot;XSS&quot;.</li><li><code>&lt;img src=x onerror=alert(&#39;XSS&#39;)&gt;</code> : Ce payload de test utilise une balise img pour injecter un script qui s&#39;exécute lorsque l&#39;image ne peut pas être chargée.</li><li><code>&lt;svg onload=alert(&#39;XSS&#39;)&gt;</code> : Ce payload de test utilise une balise svg pour injecter un script qui s&#39;exécute lors du chargement de l&#39;élément.</li><li><code>&lt;a href=&quot;javascript:alert(&#39;XSS&#39;)&quot;&gt;Click me&lt;/a&gt;</code> : Ce payload de test injecte un lien avec du code JavaScript dans l&#39;attribut href.</li><li><code>&lt;body onload=alert(&#39;XSS&#39;)&gt;</code> : Ce payload de test injecte du code JavaScript dans l&#39;événement onload de la balise body.</li></ul><p>Ces payloads de test de base peuvent être modifiés et combinés de différentes manières pour tester la réaction de l&#39;application face à des entrées malveillantes.</p><h3 id="evasion-de-filtres" tabindex="-1">Évasion de filtres <a class="header-anchor" href="#evasion-de-filtres" aria-label="Permalink to &quot;Évasion de filtres&quot;">​</a></h3><p>Les filtres sont des mécanismes de sécurité qui sont utilisés pour empêcher les attaques XSS. Cependant, il est possible d&#39;éviter ces filtres en utilisant des techniques de codage et de masquage :</p><ul><li>Utiliser des caractères Unicode ou des encodages HTML pour masquer les caractères spéciaux comme <code>&lt;</code> et <code>&gt;</code>.</li><li>Utiliser des balises HTML incomplètes ou malformées pour contourner les filtres qui recherchent des balises complètes.</li><li>Exploiter les différences de traitement entre le côté client (navigateur) et le côté serveur pour passer à travers les filtres.</li><li>Utiliser des événements JavaScript alternatifs qui ne sont pas filtrés, comme <code>onmouseover</code>, <code>onload</code>, etc.</li><li>Injecter le code malveillant dans des paramètres inattendus, comme les noms de fichiers, les en-têtes HTTP, etc.</li></ul><p>En analysant attentivement les réactions de l&#39;application face à différents payloads, les attaquants peuvent souvent trouver des moyens de contourner les filtres mis en place.</p><h3 id="encodage" tabindex="-1">Encodage <a class="header-anchor" href="#encodage" aria-label="Permalink to &quot;Encodage&quot;">​</a></h3><p>L&#39;encodage est une technique qui est utilisée pour convertir les caractères en une forme qui peut être lue par l&#39;application. Il est possible d&#39;utiliser l&#39;encodage pour éviter les filtres et exécuter du code malveillant :</p><ul><li>Encodage HTML : <code>&amp;lt;script&amp;gt;alert(&amp;#39;XSS&amp;#39;)&amp;lt;/script&amp;gt;</code></li><li>Encodage URL : <code>%3Cscript%3Ealert(%27XSS%27)%3C%2Fscript%3E</code></li><li>Encodage Unicode : <code>\\u003Cscript\\u003Ealert(\\u0027XSS\\u0027)\\u003C\\u002Fscript\\u003E</code></li><li>Encodage mixte : <code>%3Cscript%3Ealert(&#39;XSS&#39;)%3C%2Fscript%3E</code></li></ul><p>En essayant différentes techniques d&#39;encodage, les attaquants peuvent souvent trouver un moyen de contourner les filtres mis en place par l&#39;application.</p><h3 id="analyse-de-la-reponse" tabindex="-1">Analyse de la réponse <a class="header-anchor" href="#analyse-de-la-reponse" aria-label="Permalink to &quot;Analyse de la réponse&quot;">​</a></h3><p>Lorsque l&#39;on teste une vulnérabilité XSS, il est important d&#39;analyser la réponse de l&#39;application pour voir si le code malveillant a été exécuté. Il est possible d&#39;utiliser des outils comme Burp pour analyser la réponse et voir si le code malveillant a été exécuté.</p><ul><li>Présence du payload injecté dans le code HTML de la page</li><li>Exécution de fonctions JavaScript, comme <code>alert()</code>, <code>document.cookie</code>, etc.</li><li>Modifications du Document Object Model (DOM) de la page</li><li>Envoi de données à un serveur contrôlé par l&#39;attaquant</li></ul><p>Les outils comme Burp Suite peuvent être très utiles pour analyser en détail la réponse de l&#39;application et détecter les signes d&#39;une exécution réussie du code malveillant.</p><h3 id="impact" tabindex="-1">Impact <a class="header-anchor" href="#impact" aria-label="Permalink to &quot;Impact&quot;">​</a></h3><p>Les attaques XSS peuvent avoir un impact important sur la sécurité d&#39;une application. Il est possible d&#39;utiliser les attaques XSS pour voler des informations sensibles, comme des cookies ou des informations de connexion. Il est également possible d&#39;utiliser les attaques XSS pour exécuter du code malveillant sur un utilisateur sans que celui-ci ne soit conscient de l&#39;attaque.</p><ul><li>Vol de cookies de session et usurpation d&#39;identité (account takeover)</li><li>Accès à des informations sensibles stockées dans le navigateur de l&#39;utilisateur</li><li>Exécution de commandes malveillantes dans le contexte de l&#39;utilisateur victime</li><li>Redirection vers des sites web malveillants ou d&#39;hameçonnage</li><li>Modifications non autorisées des données de l&#39;utilisateur</li><li>Déni de service en saturant les ressources du serveur</li></ul><p>Selon le contexte et la nature de la vulnérabilité XSS, les dommages potentiels peuvent être très importants pour les utilisateurs et l&#39;entreprise propriétaire de l&#39;application web.</p><div class="info custom-block"><p class="custom-block-title">Sources</p><p>Ce cours s&#39;inspire (et utilise les images) de TryHackMe.com de la chambre &quot;<em>Introduction to Web Hacking</em>&quot; : <a href="https://tryhackme.com/module/intro-to-web-hacking" target="_blank" rel="noreferrer">https://tryhackme.com/module/intro-to-web-hacking</a></p></div>',36))])}const g=i(d,[["render",c]]);export{q as __pageData,g as default};
