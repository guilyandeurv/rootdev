import{_ as n,c as a,j as t,a as r,G as i,an as l,B as o,o as p}from"./chunks/framework.ys1W0Hiz.js";const u="/assets/nmap.ByeyfvaM.png",q=JSON.parse('{"title":"Nmap","description":"","frontmatter":{"sidebar":"auto"},"headers":[],"relativePath":"cybersecurite/outils/nmap.md","filePath":"cybersecurite/outils/nmap.md","lastUpdated":1729429463000}'),c={name:"cybersecurite/outils/nmap.md"};function d(m,e,h,g,v,f){const s=o("Badge");return p(),a("div",null,[e[0]||(e[0]=t("h1",{id:"nmap",tabindex:"-1"},[r("Nmap "),t("a",{class:"header-anchor",href:"#nmap","aria-label":'Permalink to "Nmap"'},"​")],-1)),i(s,{type:"tip",text:"Rédigé le 24/03/2024"}),i(s,{type:"warning",text:"En cours de rédaction"}),e[1]||(e[1]=l('<h2 id="introduction-explications" tabindex="-1">Introduction &amp; explications <a class="header-anchor" href="#introduction-explications" aria-label="Permalink to &quot;Introduction &amp; explications&quot;">​</a></h2><img src="'+u+`" width="100" height="100"><p>Supposons que l&#39;on ait reçu une adresse IP (ou plusieurs adresses IP) sur laquelle effectuer un audit de sécurité. Avant de faire quoi que ce soit d’autre, on doit <strong>avoir une idée du « paysage » qui va être attaquer</strong>. Cela signifie que l&#39;on doit <strong>établir quels services fonctionnent sur les cibles</strong>.</p><p>Par exemple, l’un d’eux exécute peut-être un serveur Web et un autre agit en tant que contrôleur de domaine Windows Active Directory. La première étape dans l’établissement de cette « carte » du paysage est ce qu’on appelle le <strong>scanning des ports</strong>. Lorsqu&#39;un ordinateur exécute un service réseau, il ouvre une construction réseau appelée « port » pour recevoir la connexion. <em><strong>Les ports sont nécessaires pour effectuer plusieurs requêtes réseau</strong></em> ou pour disposer de plusieurs services. Lorsque l&#39;on charge plusieurs pages Web à la fois dans un navigateur Web, le programme doit disposer d&#39;un moyen de déterminer quel onglet charge quelle page Web. Cela se fait en établissant des connexions aux serveurs Web distants en utilisant différents ports sur l&#39;ordinateur local. De même, si on souhaite qu&#39;un serveur puisse exécuter plusieurs services (par exemple, on veut peut-être que le serveur Web exécute à la fois les versions HTTP et HTTPS du site), on a alors besoin d&#39;un moyen de diriger le trafic vers le service approprié. Encore une fois, les ports sont la solution à ce problème. Les connexions réseau sont établies entre deux ports : un port ouvert en écoute sur le serveur et un port sélectionné au hasard sur l&#39;ordinateur.</p><p>Chaque ordinateur dispose d&#39;<em><strong>un total de 65 535 ports</strong></em> disponibles. Cependant, bon nombre d&#39;entre eux sont enregistrés comme ports standard. Par exemple, un Webservice HTTP se trouve presque toujours sur le port 80 du serveur. Un service Web HTTPS peut être trouvé sur le port 443. Windows NETBIOS peut être trouvé sur le port 139 et SMB peut être trouvé sur le port 445.</p><h2 id="options-de-nmap" tabindex="-1">Options de Nmap <a class="header-anchor" href="#options-de-nmap" aria-label="Permalink to &quot;Options de Nmap&quot;">​</a></h2><p>Nmap est accessible en tapant <code>nmap</code> dans la ligne de commande du terminal, suivi de certaines des &quot;options&quot; (arguments de commande qui indiquent à un programme de faire différentes choses).</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">┌─[root@parrot]─[~/Desktop]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└──╼</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 7.60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ( </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://nmap.org</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> )</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Usage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nmap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [Scan </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [Options] {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> specification}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[...] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Beaucoup d&#39;options...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">EXAMPLES:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scanme.nmap.org</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 192.168.0.0/16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10.0.0.0/8</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -iR</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Pn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span></span></code></pre></div><h2 id="options-principales" tabindex="-1">Options principales <a class="header-anchor" href="#options-principales" aria-label="Permalink to &quot;Options principales&quot;">​</a></h2><ul><li>Analyse UDP <code>-sU</code></li><li>Analyse TCP <code>-sT</code></li><li>Détection de l&#39;OS <code>-o</code></li><li>Versions des services executés <code>-sV</code></li><li>Verbose <code>-v</code> / amélioré <code>-vv</code></li><li>Enregistrer les résultats dans un format &quot;<em>normal</em>&quot; <code>-oN</code></li><li>Mode agressif <code>-a</code></li><li>Analyser un port en particulier <code>-p 80</code></li><li>Analyser une &quot;<em>fourchette</em>&quot; de ports <code>-p 1000-1500</code></li><li>Analyser tous les ports <code>-p</code></li><li>Activer un script <code>--script</code></li></ul><p>Lors d&#39;une analyse des ports, il y a trop types d&#39;analyse de base :</p><ul><li>TCP Connect Scans <code>-sT</code></li><li>SYN &quot;Half-open&quot; Scans <code>-sS</code></li><li>UDP Scans <code>-sU</code></li></ul><h2 id="analyse-syn-vs-tcp-vs-udp" tabindex="-1">Analyse SYN vs TCP vs UDP <a class="header-anchor" href="#analyse-syn-vs-tcp-vs-udp" aria-label="Permalink to &quot;Analyse SYN vs TCP vs UDP&quot;">​</a></h2><p>L&#39;analyse <strong>TCP</strong> Connect (<code>-sT</code>) et l&#39;analyse <strong>SYN</strong> (<code>-sS</code>) sont toutes deux des méthodes pour scanner les ports TCP sur une ou plusieurs cibles, mais elles fonctionnent différemment.</p><h3 id="analyse-tcp-connect-st" tabindex="-1">Analyse TCP Connect (<code>-sT</code>): <a class="header-anchor" href="#analyse-tcp-connect-st" aria-label="Permalink to &quot;Analyse TCP Connect (\`-sT\`):&quot;">​</a></h3><ol><li>Effectue une négociation complète à trois voies avec chaque port cible.</li><li>Envoie une <strong>requête TCP avec le drapeau SYN</strong> défini.</li><li>Si le port est ouvert, le serveur répond avec un paquet <strong>TCP contenant les drapeaux SYN/ACK</strong>.</li><li>Si le port est fermé, le serveur répond avec un paquet <strong>TCP contenant le drapeau RST</strong>.</li><li>Si le port est filtré par un pare-feu, Nmap <strong>ne reçoit pas de réponse</strong>.</li></ol><h3 id="analyse-syn-ss" tabindex="-1">Analyse SYN (<code>-sS</code>): <a class="header-anchor" href="#analyse-syn-ss" aria-label="Permalink to &quot;Analyse SYN (\`-sS\`):&quot;">​</a></h3><ol><li>Aussi connue sous le nom d&#39;analyse &quot;<em><strong>furtive</strong></em>&quot;.</li><li><strong>Ne termine pas</strong> la négociation à trois voies.</li><li>Envoie uniquement un paquet <strong>TCP avec le drapeau SYN</strong>.</li><li>Si le port est ouvert, le serveur <em>répond avec un paquet TCP contenant les drapeaux SYN/ACK</em>, mais <em><strong>Nmap envoie alors un paquet RST</strong></em> pour éviter une connexion complète.</li><li>Si le port est fermé, le serveur répond avec un paquet <strong>TCP contenant le drapeau RST</strong>.</li><li>Si le port est filtré par un pare-feu, Nmap peut ne pas recevoir de réponse, ou bien <strong>le paquet SYN peut être supprimé ou usurpé par un paquet RST</strong>.</li></ol><p>Les avantages de l&#39;analyse SYN comprennent sa <em>rapidité</em> et sa <em>furtivité</em>, ce qui peut <em>contourner certains systèmes de détection d&#39;intrusion</em> et <em>ne pas laisser de traces dans les journaux</em> des applications écoutant sur les ports ouverts. Cependant, elle nécessite des autorisations sudo sur Linux et peut perturber les services instables.</p><div class="danger custom-block"><p class="custom-block-title">Attention</p><p>Concernant la discrétion de ce scan, c&#39;était vrai il y a quelques dizaines d&#39;années. Désormais, avec les technologies actuelles, celle-ci n&#39;est plus utilisée pour des scans dit <em>furtifs</em>.</p></div><h3 id="analyse-udp-su" tabindex="-1">Analyse UDP (<code>-Su</code>) <a class="header-anchor" href="#analyse-udp-su" aria-label="Permalink to &quot;Analyse UDP (\`-Su\`)&quot;">​</a></h3><p>Lorsqu&#39;on analyse les connexions <strong>UDP</strong> avec Nmap (<code>-sU</code>), il y a quelques différences fondamentales par rapport à l&#39;analyse des connexions TCP.</p><p>Caractéristiques de l&#39;analyse UDP avec Nmap:</p><ul><li><p><em><strong>Sans état</strong></em> (stateless) : Contrairement aux connexions TCP qui suivent un processus de négociation à trois voies, les connexions UDP sont sans état. Cela signifie qu&#39;elles ne nécessitent pas de poignée de main et reposent simplement sur l&#39;envoi de paquets vers un port cible sans attente de confirmation.</p></li><li><p><em><strong>Difficulté de reconnaissance</strong></em> : L&#39;absence de réponse standardisée pour les ports ouverts rend l&#39;analyse des connexions UDP plus complexe. Nmap utilise différentes méthodes pour déterminer si un port est ouvert, fermé ou filtré.</p></li><li><p><em><strong>Identification des ports ouverts</strong></em> : Lorsqu&#39;un paquet est envoyé vers un port UDP ouvert, il ne devrait normalement y avoir aucune réponse. Si Nmap ne reçoit pas de réponse, il marque le port comme &quot;<code>open|filtered</code>&quot;. Si une réponse est reçue, le port est marqué comme &quot;open&quot;.</p></li><li><p><em><strong>Identification des ports fermés</strong></em> : Lorsqu&#39;un paquet est envoyé vers un port UDP fermé, la cible doit normalement répondre avec un paquet ICMP indiquant que le port est inaccessible. Nmap marque alors le port comme fermé.</p></li><li><p><em><strong>Lenteur de l&#39;analyse</strong></em> : En raison de la nécessité de répéter les tentatives de vérification et de l&#39;absence de réponse standardisée, l&#39;analyse des connexions UDP est beaucoup plus lente que celle des connexions TCP. Il est recommandé d&#39;utiliser l&#39;option <code>--top-ports</code> pour limiter le nombre de ports analysés et réduire ainsi le temps d&#39;analyse.</p></li><li><p><em><strong>Envoi de paquets vides ou avec charge utile</strong></em> : Nmap envoie généralement des requêtes UDP vides lors de l&#39;analyse des ports. Cependant, pour les ports occupés par des services bien connus, il peut envoyer des charges utiles spécifiques au protocole pour obtenir des réponses plus précises.</p></li></ul><p>En résumé, l&#39;analyse des connexions UDP avec Nmap nécessite une approche différente en raison de la nature sans état de UDP et de la complexité de la reconnaissance des ports ouverts.</p><h2 id="analyses-null-fin-xmas" tabindex="-1">Analyses NULL, FIN &amp; Xmas <a class="header-anchor" href="#analyses-null-fin-xmas" aria-label="Permalink to &quot;Analyses NULL, FIN &amp; Xmas&quot;">​</a></h2><p>Les analyses de ports TCP <strong>NULL</strong>, <strong>FIN</strong> et <strong>Xmas</strong> sont moins couramment utilisées que les analyses plus traditionnelles comme les analyses TCP Connect ou SYN. Cependant, elles <em>offrent une certaine furtivité supplémentaire</em>, bien que relativement parlant, par rapport aux analyses SYN furtives.</p><p>Voici un bref aperçu de chacune de ces analyses :</p><ol><li><p><em><strong>Analyse NULL</strong></em> (<code>-sN</code>) :</p><ul><li>Cette analyse envoie une requête TCP sans aucun indicateur défini.</li><li>Si le port est fermé, la RFC stipule que l&#39;hôte cible doit répondre par un paquet RST.</li><li>Si aucun paquet RST n&#39;est reçu en réponse, le port est marqué comme filtered ou open|filtered.</li></ul></li><li><p><em><strong>Analyse FIN</strong></em> (<code>-sF</code>) :</p><ul><li>Cette analyse envoie une requête TCP avec seulement le drapeau FIN défini.</li><li>Encore une fois, si le port est fermé, la cible devrait répondre avec un paquet RST.</li><li>Si aucun paquet RST n&#39;est reçu en réponse, le port est marqué comme filtered ou open|filtered.</li></ul></li><li><p><em><strong>Analyse Xmas</strong></em> (<code>-sX</code>) :</p><ul><li>Cette analyse envoie un paquet TCP mal formé avec les indicateurs PSH, URG et FIN définis.</li><li>Comme pour les analyses NULL et FIN, elle attend une réponse RST si le port est fermé.</li><li>Si aucun paquet RST n&#39;est reçu en réponse, le port est marqué comme filtered ou open|filtered.</li></ul></li></ol><p>L&#39;objectif principal de ces analyses est de <strong>contourner les pare-feu qui bloquent les paquets TCP entrants</strong> avec le drapeau SYN activé, en envoyant des requêtes qui ne contiennent pas ce drapeau. Cependant, leur <em>efficacité peut être limitée par les systèmes de détection d&#39;intrusion modernes</em>, qui sont de plus en plus capables de détecter et de bloquer ces types d&#39;analyses.</p><p>Il est également important de noter que la réponse attendue pour les ports ouverts est similaire à celle des analyses UDP : aucune réponse. Cependant, cela peut également se produire si le port est protégé par un pare-feu, donc ces analyses ne peuvent pas toujours faire la distinction entre un port ouvert et un port protégé.</p><h2 id="analyse-icmp" tabindex="-1">Analyse ICMP <a class="header-anchor" href="#analyse-icmp" aria-label="Permalink to &quot;Analyse ICMP&quot;">​</a></h2><p>Effectuer un balayage de ping est souvent la première étape lors de l&#39;exploration d&#39;un réseau dans le cadre d&#39;un test de pénétration ou d&#39;une évaluation de la sécurité. Cela permet d&#39;identifier les hôtes actifs sur le réseau.</p><p>il faut utiliser l&#39;option <code>-sn</code> en conjonction avec des plages d&#39;adresses IP ou une notation CIDR pour spécifier le réseau à analyser. Par exemple :</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 192.168.0.1-254</span></span></code></pre></div><p>ou</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 192.168.0.0/24</span></span></code></pre></div><p>L&#39;option <code>-sn</code> indique à Nmap de ne pas analyser les ports, se concentrant plutôt sur l&#39;envoi de paquets ICMP Echo Request (ou des requêtes ARP sur un réseau local si Nmap est exécuté avec sudo ou en tant qu&#39;utilisateur root) pour déterminer quels hôtes sont actifs sur le réseau.</p><p>En plus des requêtes ICMP, l&#39;option <code>-sn</code> peut également inclure l&#39;envoi de paquets TCP SYN au port 443 de chaque hôte, ainsi que des paquets TCP ACK (ou SYN si Nmap n&#39;est pas exécuté en tant que root) au port 80. Ces paquets sont envoyés pour augmenter les chances de détecter des hôtes qui pourraient filtrer les requêtes ICMP mais qui sont toujours accessibles via TCP sur ces ports courants.</p><p>Une fois que le balayage est terminé, Nmap affichera une liste des adresses IP qui ont répondu aux requêtes ICMP ou aux requêtes ARP, indiquant ainsi les hôtes actifs sur le réseau. Cela fournit une carte de la structure du réseau, qui peut être utilisée comme point de départ pour des analyses plus poussées.</p><h2 id="scripts-nse" tabindex="-1">Scripts NSE <a class="header-anchor" href="#scripts-nse" aria-label="Permalink to &quot;Scripts NSE&quot;">​</a></h2><p>Le moteur de script Nmap (NSE) offre une polyvalence impressionnante à Nmap, lui permettant d&#39;effectuer une gamme étendue de tâches de reconnaissance et de sécurité. Les scripts NSE sont écrits dans le langage de programmation <em><strong>Lua</strong></em> et peuvent être utilisés pour effectuer diverses tâches : de la recherche de vulnérabilités à l&#39;automatisation de leurs exploits.</p><ul><li><p><em><strong>safe</strong></em> : Ces scripts sont considérés comme sans risque pour la cible. Ils sont conçus pour recueillir des informations sans perturber ou affecter le fonctionnement normal des systèmes cibles.</p></li><li><p><em><strong>intrusive</strong></em> : Les scripts de cette catégorie sont plus intrusifs et peuvent potentiellement affecter la cible. Ils peuvent impliquer des activités telles que le balayage de ports, la recherche de vulnérabilités ou d&#39;autres actions qui pourraient être considérées comme des signes d&#39;activité suspecte.</p></li><li><p><em><strong>vuln</strong></em> : Les scripts de cette catégorie sont axés sur la recherche de vulnérabilités sur les cibles. Ils peuvent identifier les vulnérabilités connues et les exposer pour permettre des actions correctives.</p></li><li><p><em><strong>exploit</strong></em> : Ces scripts tentent d&#39;exploiter les vulnérabilités identifiées pour obtenir un accès non autorisé ou exécuter des actions malveillantes sur les cibles. Ils sont plus agressifs et doivent être utilisés avec précaution.</p></li><li><p><em><strong>auth</strong></em> : Les scripts d&#39;authentification tentent de contourner les mécanismes d&#39;authentification des services en cours d&#39;exécution sur les cibles. Cela peut inclure des actions telles que la connexion anonyme à un serveur FTP ou la tentative de connexion avec des informations d&#39;identification par défaut.</p></li><li><p><em><strong>brute</strong></em> : Ces scripts sont utilisés pour la force brute des informations d&#39;identification des services. Ils tentent de deviner les identifiants en utilisant une approche par essais et erreurs.</p></li><li><p><em><strong>discovery</strong></em> : Les scripts de découverte sont utilisés pour interroger les services en cours d&#39;exécution sur les cibles afin d&#39;obtenir des informations supplémentaires sur le réseau. Cela peut inclure des actions telles que l&#39;interrogation d&#39;un serveur SNMP pour obtenir des informations sur les périphériques réseau.</p></li></ul><p>Il est important de noter que l&#39;utilisation de certains scripts, en particulier ceux de catégories intrusives, vulnérabilité et exploit, peut avoir un impact sur les systèmes cibles et peut être considérée comme une activité malveillante. Il est donc essentiel de les utiliser avec prudence et de respecter les lois et réglementations en matière de sécurité informatique.</p><div class="tip custom-block"><p class="custom-block-title">Lien externe</p><p>Davantages d&#39;informations sur les scripts NSE sont disponible <a href="https://nmap.org/book/nse-usage.html" target="_blank" rel="noreferrer">ici</a>.</p></div><h3 id="utilisation-des-scripts-nse-avec-nmap" tabindex="-1">Utilisation des scripts NSE avec nmap <a class="header-anchor" href="#utilisation-des-scripts-nse-avec-nmap" aria-label="Permalink to &quot;Utilisation des scripts NSE avec nmap&quot;">​</a></h3><p>Pour activer les scripts NSE lors de l&#39;exécution de scans avec Nmap, l&#39;utilisateur utilise le commutateur <code>--script</code>. Ce commutateur permet de spécifier la catégorie de scripts à exécuter. Par exemple, pour exécuter des scripts de détection de vulnérabilités, l&#39;utilisateur utilise <code>--script=vuln</code>.</p><p>D&#39;autres catégories telles que safe pour les scripts sûrs peuvent également être spécifiées de la même manière. Exécution de Scripts Spécifiques</p><p>Pour exécuter un script spécifique, l&#39;utilisateur utilise la syntaxe <code>--script=&lt;nom-du-script&gt;</code>. Par exemple, pour exécuter un script appelé <code>http-fileupload-exploiter</code>, l&#39;utilisateur utilise <code>--script=http-fileupload-exploiter</code>. Exécution de Scripts Multiples</p><p>Il est possible d&#39;exécuter plusieurs scripts simultanément en les séparant par des virgules après le commutateur <code>--script</code>. Par exemple, pour exécuter les scripts <code>smb-enum-users</code> et <code>smb-enum-shares</code> en même temps, l&#39;utilisateur utilise <code>--script=smb-enum-users</code>,<code>smb-enum-shares</code>. Arguments des Scripts</p><p>Certains scripts nécessitent des arguments pour fonctionner correctement. L&#39;utilisateur peut fournir ces arguments en utilisant le commutateur <code>--script-args</code>. Les arguments sont séparés par des virgules et connectés au script correspondant par des points (<code>&lt;nom-du-script&gt;.&lt;argument&gt;</code>). Exemple d&#39;utilisation d&#39;arguments</p><p>Par exemple, le script <code>http-put</code> est utilisé pour télécharger des fichiers en utilisant la méthode PUT. Il nécessite deux arguments : l&#39;URL vers laquelle télécharger le fichier et l&#39;emplacement du fichier sur le disque.</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --script</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http-put</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --script-args</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http-put.url=&#39;/dav/shell.php&#39;,http-put.file=&#39;./shell.php&#39;</span></span></code></pre></div><p>Les scripts Nmap sont accompagnés de menus d&#39;aide intégrés, accessibles en utilisant la commande <code>nmap --script-help &lt;nom-du-script&gt;</code>. Bien que ces aides ne soient pas aussi détaillées que la documentation en ligne, elles fournissent des informations utiles sur l&#39;utilisation du script.</p><p>En suivant cette approche structurée, les utilisateurs peuvent mieux organiser leurs informations sur l&#39;utilisation des scripts NSE avec Nmap.</p><h3 id="recherche-et-installation-de-scripts-dans-nmap" tabindex="-1">Recherche et installation de scripts dans Nmap <a class="header-anchor" href="#recherche-et-installation-de-scripts-dans-nmap" aria-label="Permalink to &quot;Recherche et installation de scripts dans Nmap&quot;">​</a></h3><p>Pour trouver des scripts utilisables avec Nmap, les utilisateurs disposent de deux options complémentaires :</p><ol><li><p><em><strong>Page Nmap officielle</strong></em> : Cette page répertorie tous les scripts officiels de Nmap. Les utilisateurs peuvent y trouver une liste complète des scripts disponibles avec leurs descriptions et leurs cas d&#39;utilisation.</p></li><li><p><em><strong>Stockage local sur la machine</strong></em> : Sous Linux, Nmap stocke ses scripts dans le répertoire <code></code> par défaut. C&#39;est là que Nmap recherche les scripts lorsque spécifiés. Pour rechercher les scripts localement, deux méthodes peuvent être utilisées :</p><ul><li><p><strong>Utilisation du fichier <code>script.db</code></strong> : Bien qu&#39;étant un fichier texte formaté et non une base de données réelle, <strong>script.db</strong> contient les noms de fichiers et les catégories pour chaque script disponible. Par exemple, en utilisant la commande <code>grep &quot;ftp&quot; /usr/share/nmap/scripts/script.db</code>, les utilisateurs peuvent rechercher des scripts liés au FTP.</p></li><li><p><strong>Utilisation de la commande <code>ls</code></strong> : En utilisant <code>ls -l /usr/share/nmap/scripts/*ftp*</code>, les utilisateurs peuvent obtenir une liste des scripts liés au FTP. L&#39;utilisation d&#39;astérisques (*) de chaque côté du terme de recherche permet une recherche plus flexible.</p></li></ul></li></ol><h4 id="installation-de-nouveaux-scripts" tabindex="-1">Installation de nouveaux scripts <a class="header-anchor" href="#installation-de-nouveaux-scripts" aria-label="Permalink to &quot;Installation de nouveaux scripts&quot;">​</a></h4><p>Si un script recherché est manquant localement, il peut être installé de deux manières :</p><ol><li><p><em><strong>Mise à jour via APT</strong></em> : La commande <code>sudo apt update &amp;&amp; sudo apt install nmap</code> résout souvent ce problème en mettant à jour Nmap avec les derniers scripts disponibles.</p></li><li><p><em><strong>Installation manuelle</strong></em> : Les utilisateurs peuvent également télécharger manuellement le script depuis le site de Nmap en utilisant <code>sudo wget -O /usr/share/nmap/scripts/&lt;nom-du-script&gt;.nse https://svn.nmap.org/nmap/scripts/&lt;nom-du-script&gt;.nse</code>. Ensuite, exécutez <code>nmap --script-updatedb</code> pour mettre à jour le fichier <strong>script.db</strong> avec le nouveau script téléchargé.</p></li></ol><p>Il est important de noter que la même commande &quot;<strong>updatedb</strong>&quot; est nécessaire si les utilisateurs créent leurs propres scripts NSE et les ajoutent à Nmap. Cette tâche est gérable avec des connaissances de base en Lua.</p><h2 id="esquiver-les-firewall" tabindex="-1">Esquiver les firewall <a class="header-anchor" href="#esquiver-les-firewall" aria-label="Permalink to &quot;Esquiver les firewall&quot;">​</a></h2><p>Contourner les configurations de pare-feu est crucial lors de l&#39;exécution de scans de sécurité avec Nmap. Voici quelques techniques et options de commutation utiles pour contourner les pare-feu courants :</p><ul><li><p><em><strong>Option <code>-Pn</code></strong></em> : Cette option indique à Nmap de ne pas envoyer de requêtes ping à l&#39;hôte avant de l&#39;analyser. Cela permet à Nmap de traiter tous les hôtes cibles comme étant vivants, contournant ainsi le blocage ICMP. Cependant, cela peut entraîner des temps d&#39;analyse plus longs, car Nmap vérifiera chaque port spécifié même si l&#39;hôte est réellement mort.</p></li><li><p><em><strong>Requêtes ARP</strong></em> : Si vous êtes sur le réseau local, Nmap peut également utiliser les requêtes ARP pour déterminer l&#39;activité de l&#39;hôte. Cela peut contourner le blocage ICMP et fournir une détection précise des hôtes actifs.</p></li><li><p><em><strong>Options de fragmentation</strong></em> : 1. L&#39;option <code>-f</code> fragmente les paquets en morceaux plus petits, ce qui rend moins probable qu&#39;ils soient détectés par un pare-feu ou un IDS. 2. L&#39;option <code>--mtu &lt;number&gt;</code> permet de spécifier une taille maximale d&#39;unité de transmission pour les paquets envoyés, offrant un contrôle plus précis sur la fragmentation.</p></li><li><p><em><strong>Option <code>--scan-delay &lt;time&gt;ms</code></strong></em> : Cette option ajoute un délai entre les paquets envoyés. Elle est utile pour éviter les déclencheurs de pare-feu ou d&#39;IDS temporels et peut également stabiliser les scans sur des réseaux instables.</p></li><li><p><em><strong>Option <code>--badsum</code></strong></em> : Cette option génère une somme de contrôle invalide pour les paquets. Bien qu&#39;une véritable pile TCP/IP abandonnerait un tel paquet, les pare-feu peuvent répondre automatiquement sans vérifier la somme de contrôle. Cette option peut être utilisée pour détecter la présence d&#39;un pare-feu ou d&#39;un IDS.</p></li></ul><hr><br><div class="info custom-block"><p class="custom-block-title">Sources</p><p>Ce cours s&#39;inspire (et utilise les images) de TryHackMe.com de la chambre &quot;<em>Nmap</em>&quot; : <a href="https://tryhackme.com/r/module/nmap" target="_blank" rel="noreferrer">https://tryhackme.com/r/module/nmap</a></p></div>`,68))])}const y=n(c,[["render",d]]);export{q as __pageData,y as default};
